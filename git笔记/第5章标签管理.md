# 标签管理

发布一个版本时，我们通常先在版本库中打一个标签（tag），这样，就唯一确定了打标签时刻的版本。将来无论什么时候，取某个标签的版本，就是把那个打标签的时刻的历史版本取出来。所以，标签也是版本库的一个快照。

相当于是给我们的代码加上一个版本号, 随时可以找到历史库的某个版本的完整代码, 有助于我们的版本回溯

Git的标签虽然是版本库的快照，但其实它就是指向某个commit的指针（跟分支很像对不对？但是分支可以移动，标签不能移动），所以，创建和删除标签都是瞬间完成的。

Git有commit，为什么还要引入tag？

“请把上周一的那个版本打包发布，commit号是6a5819e...”

“一串乱七八糟的数字不好找！”

如果换一个办法：

“请把上周一的那个版本打包发布，版本号是v1.2”

“好的，按照tag v1.2查找commit就行！”

所以，tag就是一个让人容易记住的有意义的名字，它跟某个commit绑在一起。

## 创建标签

在Git中打标签非常简单，首先，切换到需要打标签的分支上( 如果是整个的大版本设置标签, 一般是切换到master, 如果是给某个分支设置标签, 那么就是切换到目标分支 )

```bash
$ git branch //查看当前分支
$ git checkout master //切换至主分支
$ git tag v1.0
```

![1565967065520](assets/1565967065520.png)

这样就给最新的一个版本打上了标签



### 给历史的某个节点补标签

比如我们的代码开发异常顺利, 顺利到, 现在已经是周五了, 但是我们忘记了在周三完成demo之后打上标签了, 此时,我们可以根据 git log 查找到历史的某个记录, 然后给它补上标签

![1565967343161](assets/1565967343161.png)

```bash
$ git tag v0.9 b7d5d8ec // git tag 版本号 需要打标签的那个commit的版本号
```

![1565967425511](assets/1565967425511.png)

```bash
$ git tag // 该指令可以查看当前的标签列表
```

![1565967499661](assets/1565967499661.png)

注意，标签不是按时间顺序列出，而是按字母排序的

```bash
$ git show v0.9 // 查看特定版本的提交信息
```

![1565967944132](assets/1565967944132.png)

还可以创建带有说明的标签，用`-a`指定标签名，`-m`指定说明文字：

```bash
$ git tag -a v0.1 -m "version 0.1 初始版" 01ec74f75
```

![1565968190847](assets/1565968190847.png)

添加了说明信息的标签在展示信息的时候, 会展示的比较完整

![1565969239598](assets/1565969239598.png)

标签总是和某个commit挂钩。如果这个commit既出现在master分支，又出现在dev分支，那么在这两个分支上都可以看到这个标签。



## 操作标签

###删除标签

```bash
$ git tag -d v0.1
```

因为创建的标签都只存储在本地，不会自动推送到远程。所以，打错的标签可以在本地安全删除。

![1565970028643](assets/1565970028643.png)

如果要推送某个标签到远程，使用命令`git push origin <tagname>`：

![1565970438024](assets/1565970438024.png)

或者，一次性推送全部尚未推送到远程的本地标签：

![1565970481282](assets/1565970481282.png)

如果标签已经推送到远程，要删除远程标签就麻烦一点，先从本地删除：

```bash
$ git tag -d v0.9
```

然后，从远程删除。删除命令也是push，但是格式如下：

```bash
$ git push origin :refs/tags/v0.9
```

我们可以用版本号来进行版本回滚

![1565971614929](assets/1565971614929.png)



![1565971760344](assets/1565971760344.png)

github上也会显示出版本号出来



## 小结

- 命令`git tag <tagname>`用于新建一个标签，默认为`HEAD`，也可以指定一个commit id；
- 命令`git tag -a <tagname> -m "blablabla..." 版本号`    可以指定标签信息；
- 命令`git tag`可以查看所有标签。

- 命令`git push origin <tagname>`可以推送一个本地标签；
- 命令`git push origin --tags`可以推送全部未推送过的本地标签；
- 命令`git tag -d <tagname>`可以删除一个本地标签；
- 命令`git push origin :refs/tags/<tagname>`可以删除一个远程标签。



## 关于自己的远程仓库

我们可以在github上看到很多其他大牛的代码库, 我们通过点击Fork( 叉, 分叉 )来把这个库放在自己的库里面, 这样就相当于我们自己的库里面有了一个完整的项目代码, 然后Git clone到本地, 我们可以对自己的库里所保存的备份代码进行维护和升级, 但是没法对原始项目进行维护

![1565972011466](assets/1565972011466.png)

我们自己就有了一份, 然后在克隆到本地

![1565972146103](assets/1565972146103.png)

![1565972389671](assets/1565972389671.png)

**几个库之间的关系图**

![1565972574351](assets/1565972574351.png)

如果你想修复vue的一个bug，或者新增一个功能，立刻就可以开始干活，干完后，往自己的仓库推送。

如果你希望vue的官方库能接受你的修改，你就可以在GitHub上发起一个pull request。当然，对方是否接受你的pull request就不一定了。

当你想更正别人仓库里的错误时，要走一个流程：

1. 先 fork 别人的仓库，相当于拷贝一份，相信我，不会有人直接让你改修原仓库的
2. clone 到本地分支，做一些 bug fix
3. 提交到自己的远程fork来的库
4. 发起 pull request 给原仓库，让他看到你修改的 bug
5. 原仓库 review 这个 bug，如果是正确的话，就会 merge 到他自己的项目中
  

